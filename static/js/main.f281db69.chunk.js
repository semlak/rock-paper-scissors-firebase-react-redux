(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,a,t){e.exports=t(156)},112:function(e,a,t){},156:function(e,a,t){"use strict";t.r(a);var n=t(1),r=t.n(n),o=t(24),l=t.n(o),i=t(6),s=t(28),c=t(93),u=(t(110),"FETCH_USER"),m="SIGNIN_SUCCESSFUL",p="SIGNIN_ERROR",d="SIGNOUT_SUCCESSFUL",g="SIGNOUT_REQUEST",h="SIGNOUT_ERROR",E="EMAIL_PASSWORD_LOGIN_ATTEMPT",y="EMAIL_PASSWORD_LOGIN_SUCCESS",f="EMAIL_PASSWORD_REGISTRATION_ATTEMPT",v="EMAIL_PASSWORD_REGISTRATION_SUCCESS",O="FETCH_PLAYERS",b="JOIN_GATHERING",N="LEAVE_GATHERING",A="UPDATE_STATUS",_={GAME_REQUESTED:"GAME_REQUESTED",GAME_CREATED:"GAME_CREATED",GAME_STARTED:"GAME_STARTED",GAME_ENDED:"GAME_ENDED",MAKE_PLAY:"MAKE_PLAY",PLAY_IN_PROGRESS:"PLAY_IN_PROGRESS",PLAY_RECEIVED:"PLAY_RECEIVED",ROUND_OUTCOME:"ROUND_OUTCOME",GAME_UPDATE:"GAME_UPDATE",GAME_IN_PROGRESS:"GAME_IN_PROGRESS"},I="OPEN_AUTHENTICATION_MODAL",R="CLOSE_AUTHENTICATION_MODAL",D="TOGGLE_AUTHENTICATION_MODAL",j="MODAL_MESSAGE",P=t(5),G=t(13),T={NO_GAME:"NO_GAME",GAME_STARTED:"GAME_STARTED",WAITING_FOR_BOTH_PLAYERS:"WAITING_FOR_BOTH_PLAYERS",PLAY_MADE_WAITING_FOR_OPPONENT:"PLAY_MADE_WAITING_FOR_OPPONENT",OPPONENT_PLAY_WAITING_FOR_USER:"OPPONENT_PLAY_WAITING_FOR_USER",DETERMINING_ROUND_WINNER:"DETERMINING_ROUND_WINNER",GAME_ENDED:"GAME_ENDED"},S=Object(s.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case u:return a.payload||null;default:return e}},gathering:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case b:return a.payload;case O:return Object(P.a)({},e,{onlinePlayers:a.payload});case N:return{};default:return e}},game:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{gameStatus:T.NO_GAME},a=arguments.length>1?arguments[1]:void 0;switch(Object.keys(_).indexOf(a.type)>-1&&console.log("received game action dispatch in gameReducer, state:",e,"action",a),a.type){case _.GAME_STARTED:return Object(P.a)({},e,{gameKey:a.payload.gameKey,gameData:a.payload.gameData,gameStatus:T.GAME_STARTED,myUid:a.payload.myUid,opponentUid:a.payload.gameData.player2});case _.GAME_ENDED:return Object(P.a)({},e,{gameKey:null,gameData:null,gameStatus:T.GAME_ENDED});case _.MAKE_PLAY:return function(e,a){console.log("in getGameStateAfterPlayMade, state",e);var t=e.gameStatus===T.OPPONENT_PLAY_WAITING_FOR_USER?T.DETERMINING_ROUND_WINNER:T.PLAY_MADE_WAITING_FOR_OPPONENT;return Object(P.a)({},e,{gameStatus:t,playerPlay:a.playerAction})}(e,a.payload);case _.PLAY_RECEIVED:return e.gameData?function(e,a){console.log("in getGameStateAfterPlayReceived, state:",e);var t=e.gameData,n=t.player1,r=t.player2,o=t.round,l=t.gameInProgress,i=e.myUid,s=a.player,c="player1"===s?n:"player2"===s?r:"";if(c!==n&&c!==r||""===c)return e;var u="".concat(a.player,"Actions"),m=e.gameData.round>=a.playerActions.length?a.playerActions:e.gameData[u],p=Object(P.a)({},e.gameData,Object(G.a)({},u,m)),d=p.player1Actions||[],g=p.player2Actions||[],h=l?d.length===g.length?d.length===o?T.DETERMINING_ROUND_WINNER:T.WAITING_FOR_BOTH_PLAYERS:c===i?T.PLAY_MADE_WAITING_FOR_OPPONENT:T.OPPONENT_PLAY_WAITING_FOR_USER:T.GAME_ENDED;return Object(P.a)({},e,{gameStatus:h,gameData:p})}(e,a.payload):e;case _.ROUND_OUTCOME:var t=a.payload,n=t.player1Wins,r=t.player2Wins,o=t.maxNumberOfGames,l=t.round,i=n+r>=o&&Math.abs(n-r)>=2?l:l+1;return Object(P.a)({},e,{gameData:Object(P.a)({},a.payload,{round:i}),gameStatus:T.WAITING_FOR_BOTH_PLAYERS});case _.GAME_UPDATE:return console.log("in reducer GAME_UPDATE, action.payload",a.payload),Object(P.a)({},e,{gameData:a.payload,gameStatus:a.payload&&a.payload.gameInProgress?T.WAITING_FOR_BOTH_PLAYERS:T.GAME_ENDED});case _.GAME_IN_PROGRESS:return console.log("in reducer GAME_IN_PROGRESS, action.payload",a.payload),Object(P.a)({},e,{gameData:Object(P.a)({},e.gameData,{gameInProgress:a.payload}),gameStatus:a.payload?e.gameStatus:T.GAME_ENDED});default:return e}},modals:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{authenticationModalOpen:!0},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case I:return Object(P.a)({},e,{authenticationModalOpen:!0},a.payload);case R:return Object(P.a)({},e,{authenticationModalOpen:!1},a.payload);case D:return Object(P.a)({},e,{authenticationModalOpen:!e.authenticationModalOpen},a.payload);case j:return Object(P.a)({},e,a.payload);default:return e}}}),w=(t(112),t(7)),k=t(8),M=t(10),C=t(9),U=t(11),L=t(158),W=t(159),Y=t(2),x=t(39),F=t.n(x),B=(t(118),t(121),{apiKey:"AIzaSyBkyF3iDkn4oj30QNEJ8vsnIF57PY0xki0",authDomain:"rps-game-d93c5.firebaseapp.com",databaseURL:"https://rps-game-d93c5.firebaseio.com",projectId:"rps-game-d93c5",storageBucket:"rps-game-d93c5.appspot.com",messagingSenderId:"131891175803"});F.a.initializeApp(B);var z="Games",H=new F.a.auth.GoogleAuthProvider,K=new F.a.auth.GithubAuthProvider,q=F.a,Q=function(){var e=function(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)};return function(a,t){this.db=a,this.roomName=t||"globe",this.room=this.db.ref("gatherings/"+encodeURIComponent(this.roomName)),this.myName="",this.user=null,this.updateStatus=function(e,a){this.myName=a;var t=this.db.ref(".info/connected"),n=this;t.on("value",function(e){e.val()&&n.user&&(n.user.onDisconnect().remove(),n.user.set(n.myName))})},this.join=function(a,t){var n=this;return new Promise(function(r,o){n.user&&(console.log("Already joined."),r(!1)),n.myName=t||"Anonymous - "+e(),n.user=a?n.room.child(a):n.room.push();var l=n;n.db.ref(".info/connected").on("value",function(e){e.val()&&(l.user.onDisconnect().remove(),l.user.set(l.myName))}),r(n.myName)})},this.leave=function(){this.user.remove(),this.myName=""},this.over=function(){this.room.remove()},this.onUpdated=function(e){"function"==typeof e?this.room.on("value",function(a){e(a.numChildren(),a.val())}):console.error("You have to pass a callback function to onUpdated(). That function will be called (with user count and hash of users as param) every time the user list changed.")}}}(),V=function(){return q.database().ref(z)},J=function(e){return q.database().ref("".concat(z,"/").concat(e))},Z=function(e,a){return function(t){var n="".concat(a,"Actions");return e.child(n).on("value",function(e){console.log("received updated on player action, snapshot.val()",e.val());var n=e.val(),r=n&&Object.keys(n).length>0?Object.keys(n).map(function(e){return n[e]}):[];r.length>0&&(console.log("playerActions for player",a,r),t({type:_.PLAY_RECEIVED,payload:{player:a,playerActions:r}}))})}},X=function(e,a,t){return function(n){var r=t;if(console.log("detected new game added to GamesRef, myUid:",e,"game:",r),(r.player1===e||r.player2===e)&&e.length>1&&!r.gameClosed){console.log("new game is my game");var o=r.player1Actions?Object.keys(r.player1Actions).map(function(e){return r.player1Actions[e]}):[],l=r.player2Actions?Object.keys(r.player2Actions).map(function(e){return r.player2Actions[e]}):[],i=Object(P.a)({},r,{player1Actions:o,player2Actions:l});n({type:_.GAME_STARTED,payload:{gameKey:a,gameData:i,myUid:e}});var s=r.player1,c=e===s?"player1":"player2",u=e!==s?"player1":"player2",m=J(a);n(function(e){return function(a){return e.child("round").on("value",function(){return console.log("createRoundUpdateListener listener triggered"),e.once("value",function(e){console.log("createRoundUpdateListener game snapshot",e.val());var t=e.val();a({type:_.GAME_UPDATE,payload:t})})})}}(m)),n(function(e){return function(a){return e.child("gameInProgress").on("value",function(t){console.log("received gameInProgress change indicator"),e.once("value",function(e){var t=e.val();a({type:_.GAME_UPDATE,payload:t})})}),e.child("gameClosed").on("value",function(t){if(console.log("received endGame indicator from firebase, snapshot.val()",t.val()),null==t.val()||!0===t.val()){var n=e.key;a({type:_.GAME_ENDED,payload:{gameUID:n}})}})}}(m)),n(Z(m,u)),n(Z(m,c))}}},$=function(e,a){return function(t){console.log("running changePlayerStatus, user:",e,"gathering",a),a.updateStatus(e.uid,e),t({type:A,payload:e})}},ee=function(e){function a(){var e,t;Object(w.a)(this,a);for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return(t=Object(M.a)(this,(e=Object(C.a)(a)).call.apply(e,[this].concat(o)))).play=function(e){var a=e.target.value,n=t.props.game.gameData,r=n.player1,o=n.player2,l=t.props.user.uid,i=r===l?"player1":o===l?"player2":"";if(null!=a.match(/(rock|paper|scissors)/)&&i&&i.length>1){var s=t.props.game.gameKey;t.props.makePlay(s,i,l,a)}else console.log("invalid playerAction or playerinfo",a,i)},t.endCurrentGame=function(){console.log("ending current game"),t.props.endGame&&t.props.gameUID&&(console.log("creating endGame action"),t.props.endGame(t.props.gameUID))},t.render=function(){var e,a=t.getState(),n=a.opponentName,o=a.myWins,l=a.opponentWins,i=a.ties,s=a.winner,c=t.props.game.gameStatus,u=t.props.game.gameData,m=u.gameInProgress,p=u.round,d=m&&c!==T.PLAY_MADE_WAITING_FOR_OPPONENT&&c!==T.DETERMINING_ROUND_WINNER;console.log("gameInProgress",m,"gameStatus",c);var g=(e={},Object(G.a)(e,T.DETERMINING_ROUND_WINNER,"Determining Round Winner..."),Object(G.a)(e,T.PLAY_MADE_WAITING_FOR_OPPONENT,"You have played, and we are waiting on your opponent..."),Object(G.a)(e,T.WAITING_FOR_BOTH_PLAYERS,"Waiting for both players to make a play..."),Object(G.a)(e,T.OPPONENT_PLAY_WAITING_FOR_USER,"Your opponent has played and is waiting for you to play..."),Object(G.a)(e,T.GAME_STARTED,"Game started..."),Object(G.a)(e,T.GAME_ENDED,"Game is over..."),Object(G.a)(e,T.NO_GAME,"No Game currently in progress..."),e),h=c===T.GAME_ENDED&&s>0?o>l?"You Won!":"You lost.":g[c],E=r.a.createElement(Y.e,{className:""},r.a.createElement(Y.A,null,r.a.createElement(Y.i,{className:"text-right"},"Your Opponent:"),r.a.createElement(Y.i,{className:"text-left"},n)),r.a.createElement(Y.A,null,r.a.createElement(Y.i,{className:"text-right"},"Round Number:"),r.a.createElement(Y.i,{className:"text-left "},r.a.createElement(Y.a,{color:"secondary"},p))),r.a.createElement(Y.A,null,r.a.createElement(Y.i,{className:"text-right"},"Your Wins:"),r.a.createElement(Y.i,{className:"text-left"},r.a.createElement(Y.a,null,o))),r.a.createElement(Y.A,null,r.a.createElement(Y.i,{className:"text-right"},"Opponent Wins:"),r.a.createElement(Y.i,{className:"text-left"},r.a.createElement(Y.a,null,l))),r.a.createElement(Y.A,{className:"mb-2"},r.a.createElement(Y.i,{className:"text-right"},"Ties:"),r.a.createElement(Y.i,{className:"text-left"},r.a.createElement(Y.a,null,i))),r.a.createElement(Y.b,{color:"primary",className:"mr-2 game-action",onClick:t.play,value:"rock",disabled:!d}," Rock "),r.a.createElement(Y.b,{color:"primary",className:"mr-2 game-action",onClick:t.play,value:"paper",disabled:!d}," Paper "),r.a.createElement(Y.b,{color:"primary",className:"mr-2 game-action",onClick:t.play,value:"scissors",disabled:!d}," Scissors "),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(Y.b,{color:"danger",onClick:t.endCurrentGame,id:"end-game"},"End Match"));return r.a.createElement(Y.d,{className:"border-success game",style:{display:"block"}},r.a.createElement(Y.g,{className:"text-white bg-success bg"},"Your Active Game"),E,r.a.createElement(Y.f,null,r.a.createElement(Y.h,null,h)))},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"componentDidMount",value:function(){var e=this.props,a=e.user,t=e.gathering,n=this.props.players.find(function(e){return e.uid===a.uid}),r=Object(P.a)({},n,{inGame:!0});this.props.changePlayerStatus(r,t)}},{key:"componentDidUpdate",value:function(e){var a=this.props.game,t=a.gameStatus,n=a.myUid;t===T.DETERMINING_ROUND_WINNER&&t!==e.game.gameStatus&&e.game.gameStatus.length>0&&n===this.props.game.gameData.player1&&this.props.getRoundOutcome(this.props.gameUID)}},{key:"getState",value:function(){var e=this.props.user,a=this.props.game.gameData,t=a.player1,n=a.player2,r=a.player1Wins,o=a.player2Wins,l=a.player1Name,i=a.player2Name,s=a.ties,c=a.winner,u=e.uid,m={uid:t,name:l,wins:r},p={uid:n,name:i,wins:o},d=t===u?p:n===u?m:{};return{opponentName:d.name,myWins:(t===u?m:p).wins,opponentWins:d.wins,ties:s,winner:c}}}]),a}(n.Component);var ae=Object(i.b)(function(e){var a=e.auth,t=e.gathering,n=e.game;return{user:a,gathering:t,players:null!=t&&t.onlinePlayers||[],game:n,gameUID:n.gameKey}},{endGame:function(e){return function(a){return V().child(e).remove().then(function(){a({type:_.GAME_ENDED,payload:{gameUID:e}})}).catch(function(e){a({type:_.GAME_ENDED,payload:{error:e.toString()}})})}},makePlay:function(e,a,t,n){return function(t){var r="".concat(a,"Actions");return a&&n?(t({type:_.MAKE_PLAY,payload:{player1or2:a,playerAction:n}}),V().child(e).child(r).push(n).then(function(){}).catch(function(e){return console.error("error on makePlay function",e)})):Promise.reject(new Error("unable to make play"))}},getRoundOutcome:function(e){return function(a){return V().child(e).once("value",function(t){console.log("received updated gameData from getRoundOutcome, snapshot.val()",t.val());var n=t.val();return a(function(e,a,t){return function(n){var r=e.maxNumberOfGames,o=Math.ceil(r/2),l=Object.values(e.player1Actions),i=Object.values(e.player2Actions),s=l.map(function(e,a){var t=i[a];return"rock"===e&&"paper"===t?2:"paper"===e&&"scissors"===t?2:"scissors"===e&&"rock"===t?2:e===t?0:1});console.log("wins:",s);var c=s.reduce(function(e,a){return(1===a?1:0)+e},0),u=s.reduce(function(e,a){return(2===a?1:0)+e},0),m=s.reduce(function(e,a){return(0===a?1:0)+e},0),p=c>=o?1:u>=o?2:0,d=0===p,g=l.length+(0===p?1:0);"undefined"===typeof t&&(t=J(a)),t.update({player1Wins:c,player2Wins:u,ties:m,gameInProgress:d,round:g,winner:p})}}(n,e))})}},changePlayerStatus:$})(ee),te=t(38),ne=t(29),re=function(e){return function(a){return q.auth().signInWithPopup("github"===e?K:H).then(function(e){console.log("singIn result",e),a({type:m})}).catch(function(e){a({type:p,payload:e}),console.log("signIn action error",e)})}},oe=function(){return function(e){return e(re("google"))}},le=function(){return function(e){return e({type:D})}},ie=t(97),se=t.n(ie),ce=function(e){function a(e){var t;return Object(w.a)(this,a),(t=Object(M.a)(this,Object(C.a)(a).call(this,e))).toggle=t.toggle.bind(Object(te.a)(Object(te.a)(t))),t.state={isOpen:!1},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){var e=this.props,a=this.props,t=a.auth,n=a.signOut,o=a.gathering,l=a.toggleAuthenticationModal,i=function(){return n({auth:t,gathering:o})},s=t?r.a.createElement(Y.D,{nav:!0,className:"",inNavbar:!0},r.a.createElement(Y.m,{nav:!0,caret:!0},t.photoURL?r.a.createElement(ne.a,{src:t.photoURL,alt:t.displayName,className:"",size:"25"}):r.a.createElement(ne.a,{name:t.displayName,color:ne.a.getRandomColor("sitebase",["green"]),className:"",size:"25"})),r.a.createElement(Y.l,{right:!0},r.a.createElement(Y.k,{onClick:i},"Log Out ",t.displayName),r.a.createElement(Y.k,{divider:!0}),r.a.createElement(Y.k,{disabled:!0},"Option 2"),r.a.createElement(Y.k,{divider:!0}),r.a.createElement(Y.k,{disabled:!0},"Reset"))):r.a.createElement(Y.v,null,e.auth?r.a.createElement(Y.b,{outline:!0,onClick:i},"Log Out ",t.displayName):r.a.createElement(Y.b,{outline:!0,onClick:l},"Log In/Sign Up"));return r.a.createElement(Y.x,{color:"dark",light:!0,expand:"md",dark:!0},r.a.createElement(Y.y,{href:"/"},r.a.createElement("img",{src:se.a,height:"45",alt:"Rock Paper Scissors"})),r.a.createElement(Y.z,{onClick:this.toggle}),r.a.createElement(Y.j,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(Y.u,{className:"ml-auto",navbar:!0},r.a.createElement(Y.v,{className:"ml-auto"},r.a.createElement(Y.w,{target:"_blank",href:"https://github.com/semlak/rock-paper-scissors-firebase-react-redux/"},"On Github")),r.a.createElement(Y.v,{className:"ml-auto"},r.a.createElement(Y.u,null,s)))))}}]),a}(r.a.Component);ce.defaultProps={auth:{}};var ue=Object(i.b)(function(e){return{auth:e.auth,gathering:e.gathering}},{signOut:function(e){var a=e.gathering;return function(e){return e({type:g}),a&&Object.keys(a).length>0&&"function"===typeof a.leave?e(function(e){return function(a){null!=e&&"undefined"!==typeof e&&(e.leave(),a({type:N}))}}(a)):console.log("not leaving gathering, because it does not appear to be defined"),e(function(e){var a=q.auth();return a.currentUser?(a.signOut().then(function(){return e({type:d}),Promise.resolve(!0)}).catch(function(a){e({type:h,payload:a})}),Promise.resolve(!0)):(e({type:h,payload:"error on signout"}),Promise.resolve(!1))})}},toggleAuthenticationModal:le})(ce),me=t(0),pe=t.n(me),de=function(e){var a=function(a){function t(){return Object(w.a)(this,t),Object(M.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(U.a)(t,a),Object(k.a)(t,[{key:"componentWillMount",value:function(){null===this.props.auth&&this.context.router.history.push("/")}},{key:"componentWillUpdate",value:function(e){e.auth||this.context.router.history.push("/")}},{key:"render",value:function(){return this.props.auth?r.a.createElement(e,this.props):null}}]),t}(n.Component);return a.contextTypes={router:pe.a.object},Object(i.b)(function(e){return{auth:e.auth}})(a)},ge=(t(91),t(98)),he=t.n(ge),Ee=function(e){function a(){return Object(w.a)(this,a),Object(M.a)(this,Object(C.a)(a).apply(this,arguments))}return Object(U.a)(a,e),Object(k.a)(a,[{key:"componentWillUpdate",value:function(e){e.auth&&this.context.router.history.push("/app")}},{key:"signIn",value:function(e){e.preventDefault(),this.props.signIn()}},{key:"render",value:function(){return r.a.createElement("div",{className:"row social-signin-container"},r.a.createElement("div",{className:"col s10 offset-s1 center-align"},r.a.createElement("img",{alt:"Sign in",id:"sign-in",src:he.a}),r.a.createElement("h4",{id:"sign-in-header"},"Sign In to start"),r.a.createElement("a",{href:"/#",className:"social-signin",onClick:this.props.signIn},r.a.createElement("i",{className:"fa fa-google social-signin-icon"}),"Sign in with Google")))}}]),a}(n.Component);Ee.contextTypes={router:pe.a.object};Object(i.b)(function(e){return{auth:e.auth}},{signIn:oe})(Ee);var ye=function(e){var a=e.player;return a.photoURL&&a.photoURL.length>0?r.a.createElement("img",{src:a.photoURL,height:"25",alt:a.displayName}):r.a.createElement(ne.a,{name:a.displayName,color:ne.a.getRandomColor("sitebase",["green"]),size:"25",textSizeRatio:2})},fe=function(e){function a(){return Object(w.a)(this,a),Object(M.a)(this,Object(C.a)(a).apply(this,arguments))}return Object(U.a)(a,e),Object(k.a)(a,[{key:"componentDidMount",value:function(){this.updatePlayerStatusIfNeccessary()}},{key:"componentDidUpdate",value:function(){this.updatePlayerStatusIfNeccessary()}},{key:"updatePlayerStatusIfNeccessary",value:function(){var e=this.props,a=e.auth,t=e.gathering,n=this.props.players.find(function(e){return e.uid===a.uid});if(n&&!1!==n.inGame){var r=Object(P.a)({},n,{inGame:!1});this.props.changePlayerStatus(r,t)}}},{key:"render",value:function(){var e=this.props,a=e.selectPlayer,t=e.auth,n=e.players&&Array.isArray(e.players)?e.players:[];return r.a.createElement(Y.d,{className:"border-info app",id:"available-players",style:{display:"block"}},r.a.createElement(Y.e,{className:""},n.length<1?"Loading players...":n.map(function(e){return r.a.createElement(Y.b,{key:e.uid,onClick:function(){return a(e.uid)},color:"primary",className:"mr-1 mb-1",outline:!0,disabled:e.uid===t.uid||e.inGame,title:"".concat(e.displayName).concat(e.inGame?" (currently in a game)":e.uid===t.uid?" (You cannot play against yourself)":"")},e.uid===t.uid?"You (".concat(e.displayName,")"):e.displayName," ",r.a.createElement("span",null," ",r.a.createElement(ye,{player:e})))})))}}]),a}(n.Component);var ve=Object(i.b)(function(e){var a=e.auth,t=e.gathering;return{auth:a,gathering:t,players:null!=t&&t.onlinePlayers||[]}},{changePlayerStatus:$})(fe),Oe=function(e){function a(e){var t;return Object(w.a)(this,a),(t=Object(M.a)(this,Object(C.a)(a).call(this,e))).state={activeTab:"1"},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"toggleTab",value:function(e){this.state.activeTab!==e&&this.setState({activeTab:e})}},{key:"render",value:function(){var e=this,a=this.props,t=a.signIn,n=a.signInWithGithub,o=a.authenticationModalOpen,l=a.toggleAuthenticationModal;return r.a.createElement(Y.s,{isOpen:o,toggle:l,size:"lg",className:this.props.className},r.a.createElement(Y.t,null,r.a.createElement(Y.A,{className:"row"},r.a.createElement(Y.i,{lg:8,md:12,className:"add-right-border"},r.a.createElement(Y.u,{tabs:!0},r.a.createElement(Y.v,null,r.a.createElement(Y.w,{className:"1"===this.state.activeTab?"active":"",onClick:function(){e.toggleTab("1")}},"Login")),r.a.createElement(Y.v,null,r.a.createElement(Y.w,{className:"2"===this.state.activeTab?"active":"",onClick:function(){e.toggleTab("2")}},"Registration"))),r.a.createElement(Y.B,{activeTab:this.state.activeTab,className:"mt-2",id:"nav-tab-content"},r.a.createElement(Y.C,{tabId:"1"},r.a.createElement(Ae,{closeButtonAction:l})),r.a.createElement(Y.C,{tabId:"2"},r.a.createElement(Re,{closeButtonAction:l}))),r.a.createElement("div",{id:"OR",className:""},"OR")),r.a.createElement(Y.i,{sm:12,md:12,lg:4,className:"hidden-lg-down"},r.a.createElement(Y.A,{className:"text-center sign-with"},r.a.createElement(Y.i,{md:12},r.a.createElement("h5",null,"Sign in with")),r.a.createElement(Y.i,{md:12},r.a.createElement(Y.c,null,r.a.createElement(Y.b,{id:"github-signin",onClick:n},"Github"),r.a.createElement(Y.b,{color:"danger",id:"google-signin",onClick:t},"Google"))))))))}}]),a}(r.a.Component);Oe.defaultProps={};var be=Object(i.b)(function(e){return{authenticationModalOpen:e.modals.authenticationModalOpen}},{signIn:oe,signInWithGithub:function(){return function(e){return e(re("github"))}},toggleAuthenticationModal:le})(Oe),Ne=function(e){function a(e){var t;return Object(w.a)(this,a),(t=Object(M.a)(this,Object(C.a)(a).call(this,e))).handleInputChange=function(e){return t.setState(Object(G.a)({},e.target.name,e.target.value))},t.handleLoginClick=function(e){e.preventDefault(),console.log("in handleRegisterClick");var a=t.state,n=a.email,r=a.password;r.length>=6?t.props.loginUserWithEmailPassword({email:n,password:r}):console.error("password needs to be at least 6 characters")},t.state={email:"",password:""},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"render",value:function(){var e=this.state,a=e.email,t=e.password,n=this.handleInputChange;console.log("this.props",this.props);var o=this.props.modals,l=o.loginError,i=o.message,s=!l&&"undefined"!==typeof l||void 0,c=!(!l||"undefined"===typeof l)||void 0;return r.a.createElement(Y.n,null,r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"email",sm:3},"Email"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:s,invalid:c,type:"email",name:"email",value:a,placeholder:"Email",onChange:n}))),r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"password",sm:3},"Password"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:s,invalid:c,type:"password",name:"password",value:t,placeholder:"password",onChange:n}),r.a.createElement(Y.o,{valid:s,invalid:"undefined"!==typeof c?"false":void 0},i))),r.a.createElement(Y.A,null,r.a.createElement(Y.i,{sm:{size:9,offset:3}},r.a.createElement(Y.b,{color:"primary",onClick:this.handleLoginClick},"Submit"),r.a.createElement(Y.b,{color:"danger",onClick:this.props.closeButtonAction,className:"ml-2","data-dismiss":"modal"},"Cancel"))))}}]),a}(r.a.Component);Ne.defaultProps={};var Ae=Object(i.b)(function(e){return{auth:e.auth,gathering:e.gathering,modals:e.modals}},{loginUserWithEmailPassword:function(e){var a=e.email,t=e.password;return function(e){var n=q.auth();return e({type:E}),n.signInWithEmailAndPassword(a,t).then(function(){e({type:y}),e({type:j,payload:{loginError:!1,message:"Login was successful!"}}),setTimeout(function(){return e({type:R,payload:{loginError:void 0}})},1600)}).catch(function(a){e({type:j,payload:{loginError:!0,message:a.message}})})}}})(Ne),_e=function(e){return!!e.match("[a-zA-Z]+.*@.*[a-zA-Z]+.*[.][a-zA-Z]+")},Ie=function(e){function a(e){var t;return Object(w.a)(this,a),(t=Object(M.a)(this,Object(C.a)(a).call(this,e))).handleInputChange=function(e){return t.setState(Object(G.a)({},e.target.name,e.target.value))},t.handleRegisterClick=function(e){e.preventDefault(),console.log("in handleRegisterClick");var a=t.state,n=a.username,r=a.email,o=a.password,l=a.passwordConfirm;return n.length<1?console.error("need valid username"):_e(r)?o.length<6?console.error("need password of length 6 or more characters"):o!==l?console.error("password and confirmation did not match"):(console.log("data is valid. Registering user"),t.props.registerUserAction({username:n,email:r,password:o})):console.error("need valid email")},t.state={username:"",email:"",password:"",passwordConfirm:""},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"render",value:function(){var e=this.state,a=e.username,t=e.email,n=e.password,o=e.passwordConfirm,l=this.handleInputChange;console.log("this.props",this.props);var i=this.props.modals,s=i.registrationError,c=i.message,u=!s&&"undefined"!==typeof s||void 0,m=!(!s||"undefined"===typeof s)||void 0;return r.a.createElement(Y.n,{autoComplete:"off"},r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"name",sm:3,className:"pr-0"},"Display Name"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:u,invalid:m,type:"text",name:"username",value:a,placeholder:"Display Name",onChange:l}))),r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"email",sm:3},"Email"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:u,invalid:m,type:"email",name:"email",value:t,placeholder:"Email",onChange:l}))),r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"password",sm:3},"Password"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:u,invalid:m,type:"password",name:"password",value:n,placeholder:"Password (6-character minimum)",onChange:l,autoComplete:"off"}))),r.a.createElement(Y.p,{row:!0},r.a.createElement(Y.r,{for:"passwordConfirm",sm:3},"Confirm"),r.a.createElement(Y.i,{sm:9},r.a.createElement(Y.q,{valid:u,invalid:m,type:"password",name:"passwordConfirm",value:o,placeholder:"Confirm Password",onChange:l}),r.a.createElement(Y.o,{valid:u,invalid:"undefined"!==typeof m?"false":void 0},c))),r.a.createElement(Y.A,null,r.a.createElement(Y.i,{sm:{size:9,offset:3}},r.a.createElement(Y.b,{color:"primary",onClick:this.handleRegisterClick},"Register"),r.a.createElement(Y.b,{color:"danger",onClick:this.props.closeButtonAction,className:"ml-2","data-dismiss":"modal"},"Cancel"))))}}]),a}(r.a.Component);var Re=Object(i.b)(function(e){return{modals:e.modals}},{registerUserAction:function(e){var a=e.username,t=e.email,n=e.password;return function(e){var r=q.auth();return e({type:f}),r.createUserWithEmailAndPassword(t,n).then(function(){e({type:v});var t=r.currentUser;t.updateProfile({uid:t.uid,displayName:a}).then(function(){setTimeout(function(){return e({type:R,payload:{registrationError:void 0}})},2e3),e({type:u,payload:q.auth().currentUser}),e({type:j,payload:{registrationError:!1,message:"Registration was successful!"}})})}).catch(function(a){e({type:j,payload:{registrationError:!0,message:a.message}})})}}})(Ie),De=t(99),je=t.n(De),Pe=function(e){function a(){var e,t;Object(w.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(M.a)(this,(e=Object(C.a)(a)).call.apply(e,[this].concat(r)))).toggleModal=function(e){console.log("toggleModal"),e.preventDefault(),t.props.toggleAuthenticationModal()},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"componentWillUpdate",value:function(e){e.auth&&this.context.router.history.push("/app")}},{key:"signIn",value:function(e){e.preventDefault(),this.props.signIn()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.A,{className:"row social-signin-container"},r.a.createElement(Y.i,{className:"col s10 offset-s1 center-align"},r.a.createElement("img",{alt:"Sign in",id:"sign-in",width:"100%",src:je.a}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("a",{href:"/#",className:"social-signin",onClick:this.toggleModal},"Sign in to start"))),r.a.createElement(Y.A,{className:"mt-4 text-left"},r.a.createElement(Y.i,null,r.a.createElement(Y.d,{body:!0,outline:!0,color:"danger"},r.a.createElement("p",null,"For trying out the game with multiple players, you can use separate logins in separate browsing sessions."),r.a.createElement("p",null,"You can create your own logins or use the following sample logins (each with password '",r.a.createElement("samp",null,"password"),"'):"),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("samp",null,"harry@hogwarts.co.uk")),r.a.createElement("li",null,r.a.createElement("samp",null,"ron@hogwarts.co.uk")),r.a.createElement("li",null,r.a.createElement("samp",null,"hermione@hogwarts.co.uk")))))))}}]),a}(n.Component);Pe.contextTypes={router:pe.a.object};var Ge=Object(i.b)(function(e){return{auth:e.auth}},{toggleAuthenticationModal:le})(Pe),Te=function(e){function a(){var e,t;Object(w.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(M.a)(this,(e=Object(C.a)(a)).call.apply(e,[this].concat(r)))).state={},t.selectPlayer=function(e){var a=t.props,n=a.auth,r=a.players;return t.props.requestGame(n,r.find(function(a){return a.uid===e}))},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"componentDidMount",value:function(){var e=this.props;!e.auth||e.gathering&&Object.keys(e.gathering).length>0||this.props.joinGathering(e.auth)}},{key:"render",value:function(){var e=this.props.game,a=this.props.players&&Array.isArray(this.props.players)?this.props.players:[];return r.a.createElement("div",{id:"main",style:{display:"block"}},r.a.createElement(Y.e,{className:""},e&&Object.keys(e).length>1&&e.gameKey&&e.gameKey.length>1?r.a.createElement(ae,{gameUID:e.key}):!a||a.length<0?r.a.createElement("div",null,"Loading"):r.a.createElement(ve,{players:"players",selectPlayer:this.selectPlayer})))}}]),a}(n.Component);var Se=Object(i.b)(function(e){var a=e.auth,t=e.gathering,n=e.game;return{auth:a,gathering:t,players:null!=t&&t.onlinePlayers||[],game:n}},{joinGathering:function(e){return function(a){var t=new Q(q.database(),"OnlineUsers"),n=e.photoURL;t.join(e.uid,{displayName:e.displayName,inGame:!1,photoURL:n}).then(function(){var n;t.onUpdated(function(e,t){var n=e>0&&t&&Object.keys(t).length>0?Object.keys(t).map(function(e){return Object(P.a)({},t[e],{uid:e})}):[];a({type:O,payload:n})}),a((n=e.uid,function(e){return V().on("child_added",function(a){return e(X(n,a.key,a.val()))})}))}).catch(function(e){return console.log("error when joining gathering",e)}),a({type:b,payload:t})}},requestGame:function(e,a){return function(t){t({type:_.GAME_REQUESTED,payload:{user:e,otherPlayer:a}});var n=e.uid,r=e.displayName,o=a.uid,l=a.displayName;if(n&&o&&n.length>0&&o.length>0){var i={player1:n,player2:o,player1Wins:0,player2Wins:0,player1Name:r,player2Name:l,ties:0,maxNumberOfGames:5,gameInProgress:!0,gameClosed:!1,winner:0,round:1};return V().push(i).then(function(){return t({type:_.GAME_CREATED})}).catch(function(e){return console.log("error when creating new game",e),Promise.reject(e)})}return console.log("not creating new game"),Promise.reject(new Error("not creating new game"))}}})(Te),we=function(e){function a(){var e,t;Object(w.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=Object(M.a)(this,(e=Object(C.a)(a)).call.apply(e,[this].concat(r)))).componentDidMount=function(){t.props.fetchUser()},t}return Object(U.a)(a,e),Object(k.a)(a,[{key:"render",value:function(){return console.log("rendering App component"),console.log("Your process.env.PUBLIC_URL: '".concat("/rock-paper-scissors-firebase-react-redux","'")),r.a.createElement(L.a,{basename:"/rock-paper-scissors-firebase-react-redux"},r.a.createElement("div",{className:"App"},r.a.createElement(ue,null),r.a.createElement(be,null),r.a.createElement("div",{className:"container main"},r.a.createElement(W.a,{exact:!0,path:"/",component:Ge}),r.a.createElement(W.a,{path:"/app",component:de(Se)}))))}}]),a}(n.Component),ke=Object(i.b)(null,{fetchUser:function(){return function(e){return q.auth().onAuthStateChanged(function(a){console.log("onAuthStateChanged triggered from fetchUser"),a&&a.displayName?(e({type:u,payload:a}),e({type:R,payload:{loginError:void 0}})):e({type:u,payload:null})})}}})(we),Me=Object(s.d)(S,{},Object(s.a)(c.a));l.a.render(r.a.createElement(i.a,{store:Me}," ",r.a.createElement(ke,null)),document.getElementById("root"))},91:function(e,a,t){},97:function(e,a,t){e.exports=t.p+"static/media/rpsLogo.94b40bc8.png"},98:function(e,a,t){e.exports=t.p+"static/media/user.160c68fc.png"},99:function(e,a,t){e.exports=t.p+"static/media/landing-rps.7015b724.jpg"}},[[101,2,1]]]);
//# sourceMappingURL=main.f281db69.chunk.js.map